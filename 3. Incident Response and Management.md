## 3.1 Explain concepts related to attack methodology frameworks.
---
**Cyber kill chain**

| Stage                 | Description                                                                                                                                                                                                                                                                                                                                                         |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Reconnaissance        | The adversary gathers information about the network using network probes, open-source intelligence (OSINT), and social engineering. The aim is to map the total attack surface and identify potential attack vectors. Targets are then researched, identified, and ultimately selected.                                                                             |
| Weaponization         | The attacker identifies a method by which identified vulnerabilities can be exploited, often through weaponized code, such as carefully crafted scripts, custom malware binaries, compromised websites, social engineering, and other methods. The exploit code is coupled with a payload that will assist the attacker in maintaining and extending covert access. |
| Delivery              | The weaponized code is inserted into the environment using a selected attack vector, such as email attachment, phishing website/download, USB media, and so on.                                                                                                                                                                                                     |
| Exploitation          | This results in the weaponized code running on the target system. For example, a phishing email may trick the user into running the code, while a drive-by download would execute on a vulnerable system without user intervention.                                                                                                                                 |
| Installation          | The payload is successfully installed on the target system using methods to remain undetected and achieve persistence.                                                                                                                                                                                                                                              |
| Command and Control   | During this stage, the payload establishes a connection to a remote server, enabling the attacker to connect to the target and download or fabricate additional information. (Also known as C&C or C2.)                                                                                                                                                             |
| Actions on Objectives | The adversary uses the compromised system to achieve or progress towards goals, such as data exfiltration, DoS vandalism, or escalating access across the target network or other connected networks.                                                                                                                                                               |

**Diamond Model of Intrusion**- framework to analyze an intrusion event; used to develop automated threat intelligence analysis engines that integrates with SIEM

| Feature                                           | Description                                                                                                                                                                                                        |
| ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Adversary                                         | This element represents the individual or group responsible for the intrusion. Adversaries can include nation states, criminal organizations, hacktivists, or malicious insiders.                                  |
| Infrastructure<br>(Attacker's physical resources) | This element refers to the tools and resources used by the adversary to carry out the intrusion. Tools include malware, exploit kits, command and control servers, and other types of network infrastructure.      |
| Capability<br>(Attacker's Capability)             | This element describes the technical skills and aptitude of the adversary, such as their ability to craft advanced techniques to evade detection, exploit vulnerabilities, and persist on target systems.          |
| Victim                                            | The victim element represents the organization or individual the adversary has targeted, such as government agencies, businesses, or individuals. Victims vary in size, industry type, and defensive capabilities. |
![[Diamond_model_Framework.png]]

**Analysis**
**MITRE ATT&CK**- matrices provide access to a database of known tactics, techniques, and procedures (TTPs)
each TTP has a unique ID and places it in one or more tactic categories (initial access, persistence, lateral movement, or command and control, etc). 
the sequence in which attackers may deploy any tactic is not defined, so analysts must interpret each attack lifecycle from local evidence.
The framework also allows analysts to compare the TTPs used by different threat groups, like APTs 

List of different TTPs used on each stage of the kill chain. Reconnaissance: TTP1, TTP2, etc. Weaponization: TTP1, ... 

**Open Source Security Testing Methodology Manual (OSS TMM)**- is a framework that provides a comprehensive and structured approach to security testing. Helps develop consistent and repeatable testing processes across all systems to ensure that security testing is conducted thoroughly and consistently. IS FREE & OPEN SOURCE
Covers many different aspects:
- Security Analysis
- Operational Security Metrics
- Trust Analysis
- Work Flow
- Human Security Testing
- Physical Security Testing
- Telecommunications Security Testing
- Data Networks Security Testing
- Compliance Regulations
- Reporting with the STAR (Security Test Audit Report)


**OWASP Testing Guide** It defines:
- **What to test** (e.g., authentication, session management, input validation)
- **How to test it** (step-by-step procedures)
- **Why it's important** (risk and attack explanation)
- **Tools that can be used** for each test (like Burp Suite, OWASP ZAP)
Relates to the OWASP top 10- helps test for those top 10 vulns 

Extras: 


## 3.2 Given a scenario, perform incident response activities.
---
**Detection and analysis**

- **IoC**- 1St step when looking at IR. Logging is a huge part of this, Logging best practices (Using SIEMs, Time sync, integration of threat intelligence), Analyze IoCs with Forensics (look below)
**Evidence acquisitions:** Preserving forensic artifacts is essential for understanding the attack path, identifying vulnerabilities, and supporting legal or compliance investigations, done within containment. 
- **Chain of custody**- prevents tampering of data when one goes in to analyze it 
- **Validating data integrity**- common data integrity techniques like hashing
- **Preservation**- Hold onto data for a longer time
- **Legal hold**- An hold you can put on data during a incident -> Preserve the data for litigation
- **Data and log analysis**- to mainly identify IoCs, for IR when looking at events in a SIEM. 

**Containment, eradication, and recovery**
**Isolation**- remove the compromised device from any connections to the network also refer to disabling a user account or app service. Physically isolate these systems, Once isolated:
- Observe the activities and behaviors of the system.
- Study and test the system to ensure it is safe to use.
- Share findings of indicators of compromise, behavior, and eradication methods with other organizations through online security trackers such as the ISAC and the CERT.
the chosen isolation method directly impacts forensic analysts and can potentially violate established policies or SLAs. <- balance these requirements with the risks associated with inaction
Segmented networks help with Containment. <-disconnect that segment, also attacker needs the capability to move to other segments. 

Cryptographic erase- destroys the device's cryptographic key. If the device is encrypted and you destroy the key, the data is deemed useless and can be overwritten.
Forensic sanitation
Disposal- Destroying drives, degassing, etc. <- use a destruction company for auditing and license. 
Reconstitution of Resources:
1. Ensure that the system has been contained.
2. Use a combination of software tools and manual searches to find any signs of malware.
3. Terminate any processes that appear suspicious and delete all traces of the source software from the system.
4. Disable any autostart locations in your file system, registry, and the task scheduler to prevent these processes from executing.
5. Reinstall the operating system and applications with new, clean versions from trusted sources.
6. Restart the system in a contained environment and reanalyze for signs of malware or suspicious activity.
7. Return the system to a live environment only if the infection seems to have been removed.
8. Monitor the system closely.

- **Scope** of incident 
- **Impact** of incident
-  **Re-imaging**
Recovery- go back to normal business operations, steps to recover depands on impact of the incident and how well prepared you are for the incident. 
- **Remediation**- the corrective actions taken to address a problem or issue permanently, replacing faulty hardware or software, preventing the same issue from happening. 
	->how lessons learned and root cause analysis is incorporated into policies, procedures, and technological improvements to ensure the problem does not reoccur
- **Compensating controls**- compensating control is needed when an overriding business or technical reason prevents deploying the primary control recommended by the standard <- for Certain Compliance standards like PCI DSS 

## 3.3 Explain the preparation and post-incident activity phases of the incident management life cycle.
---

**Preparation**- 
IRP (incident response plan)- will provide the guidelines, resources, and protocols needed to minimize the impact of a security incident and ensure business continuity. Expose potential risks and outline appropriate responses. <- more of a formal document/methodology. This can be a flow chart of what to do for certain incidents
Planning includes threat modeling, risk analysis, policy and process development, testing, and simulations
![[IR_Plan.png]]

Playbook- includes the plan the necessary tasks needed to respond to a certain incident scenario. (ransomware playbooks, etc)
Common Tools to use during IR: 

| Tool                                             | Description                                                                                                                                                                                                                                                |
| ------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Security Information and Event Management (SIEM) | Collect and analyze log data and provide a single viewpoint for logs collected from many sources. It helps to locate specific events or event sequences.                                                                                                   |
| Intrusion detection systems (IDS)                | Provides alerts when suspicious events occur based on established or custom-crafted signatures developed to locate events specific to an incident.                                                                                                         |
| Vulnerability scanners                           | Identify the presence of a vulnerability, especially one under active attack, and can also provide assurance that a previously identified vulnerability has been remediated.                                                                               |
| NetFlow Analyzers                                | Provide high-level visibility into the volumes of traffic and protocols in use in the environment.                                                                                                                                                         |
| Infrastructure monitoring                        | Tools used to monitor availability, latency, capacity, and other elements. Typically associated with engineering teams and used to ensure the health and uptime of infrastructure components such as servers, storage environments, and network equipment. |
| Proxies and gateways                             | Firewalls, routers, and forward proxies (internet traffic) provide valuable insight into traffic leaving and entering the network. These can be used to alert specific traffic or analyzed to locate historical events.                                    |
Training- Effective training on incident detection and reporting procedures equip staff with the knowledge to react swiftly and effectively to security events. Cross-departmental training is important too as many departments are part of IR procedure. 
TableTop- The individual leading the tabletop exercise outlines a specific (imaginary) event to which the team must respond. During the response, the activity leader will expand on the scenario by adding new details or an additional event/consequence to which the participating teams must adapt. As the team makes decisions, the facilitator provides realistic consequences and responses. The team has to manage many different issues during the IR and after the incident. 
PenTesting- Leadership can initiate testing in this way with or without the knowledge of the incident responders. Excluding incident responders from the plan can evaluate their effectiveness

| Type       | Description                                                                                                                                                                                                                             |
| ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Red team   | These are skilled hackers that use their skills to attack the specified target. Often, this team is outsourced since most internal staff are aware of internal controls used to block access.                                           |
| Blue team  | These are the skilled defenders of the network. They are the defensive side in the exercise. They use their skills to configure protection devices, scan and monitor the network for unusual activity, and do what they can to stop it. |
| White team | This team is comprised of managers, assessors, and other technical and non-technical staff. Their purpose is to design the rules of engagement, organize teams, and adjudicate the exercise.                                            |


**Post-incident activity**- 
Forensic analysis- Preserve forensic evidence of the intrusion. While waiting for the forensics analyst to arrive, treat the system like any crime scene by preventing anyone from further compromising the system or destroying evidence
Root cause analysis- finding the absolute root cause of the attack. what caused this incident. 
Lessons learned- usually a meeting to see what went well and wrong during the Incident response. and what changes need to be made for a more successful IR. 

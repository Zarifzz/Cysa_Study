## 2.4 Given a scenario, recommend controls to mitigate attacks and software vulnerabilities.
---
### Recommend Controls:



**• Cross-site scripting**
- **Reflected** - Not stored; Malicious part in sent in HTTP request to server -> server then sends back a exploited response which then does the attack. This is usually done in the URL in the search field. 
- **Persistent** - Malicious part is actually stored in the server. Everyone who visits is "attacked"

Webapp vuln Scanning- ZAP, Nikto
Static and Dynamic analysis- code reviews, fuzzing
Threat intel- OWASP Top 10
input validation and output encoding
Secure Coding
CSP (Content Security Policy headers) - browser/webapp has to follow these policies; disallow mal scripts
WAFs


**• Overflow vulnerabilities**
- **Buffer**
- **Integer**- Exceeds the storage capacity of the "number" data type used. -> incorrect logic -> bypassing security/exploitation
- **Heap**- overwrites dynamic memory, can only heap overflow/exploit at runtime. Detection is only done at runtime too. 
- **Stack**- overwrites return calls -> leads to returning into a malicious payload

Secure Coding, Static/Dynamic analysis, Fuzzing, Threat Intel about known overflows, Patching to get rid of certain exploitable vulns 

**• Data poisoning**- introduces false, manipulated, or malicious data into a data system w/ the intent to corrupt data systems. Messes up Machine Learning Models and data dependent Algorithms
Targeted/UnTargeted- targeted poisoning to influence certain outcomes (causing a spam filter to misclassify malicious content), untargeted degrades the hole system with a lot of bs data. 

monitoring and validation of data integrity, 
data hygiene practices at all levels (On path data poisoning attacks), 
Statistical analysis (outlier detection, standard deviation), 
Automation- automated validation rules
Threat intel-  Identifies Data Poisoning campaigns 

**• Broken access control**- bypass the intended restrictions, unauthorized use of resources. Failed AuthZ. 
Includes Privilege Escalation, IDOR (exposes object identifiers like DB keys and UserIDs, allows attacker to change them w/out AuthZ), Access to UnAuthZ web server urls, directory traversal. 

Burp Suite and OWASP ZAP- intercept traffic, modify requests, and observe
Secure coding- session management, token usage, etc
principle of least privilege
Verifying Access control on all project resources- Resources like DB, APIs, Backend services, etc
WAFs
Monitoring and auditing

**• Cryptographic failures** - When crypto is not implemented correctly. -> leads to data confidentiality loss, integrity loss if Hashing doesn't work. Forged digital signatures. 
Outdated/weak algorithms, Using default crypto configs, Bad key management (hard coding keys, not swapping keys, etc), Bad random number gen (low-entropy)

Automated tools/ Config Audits
Document which algorithms are in use, where encryption is applied, how keys are managed, and which systems depend on cryptographic operations
Following industry-recognized best practices 
Centralized key management systems - PKIs, HSMs, TPMs, 

**• Injection flaws**- user-supplied (usually malicious) input directly into an execution context like database query, system command, or directory lookup, no validation. 
SQL injections, Command injection (sys command executed by the OS), LDAP injection (malicious management  and queries of directory services), XML injection (Alters XML parser behavior, use XML External Entity to include external files)

Secure Coding- insufficient input validation, failure to use parameterized queries, insecure string concatenation, and lack of output encoding
code reviews, dynamic testing, and vuln scanning
Vuln scanners- Burp Suite, OWASP ZAP, SQLmap, and Nessus
Pentesting, Fuzzing
Use secure coding frameworks
Threat intel- public vulnerability disclosures, attacker playbooks, and malware analysis reports; tune scanning tools, update WAF rules, and prioritize remediation

**• Cross-site request forgery**- XSS to specifically target already authenticated services on signed in browser, EX. XSS attack that checks if you are signed into your social media, then forges actions on your social media account
**• Directory traversal**- See dirs on a web server; broken access control
**• Insecure design**- Flaws in application architecture; is too deep rooted to fix with a simple patch, must redo entire design. not necessarily insecure coding -> insecure everything
No thought of AuthN, using insecure communication, poor session management, 

Threat modeling throughout the SDLC
STRIDE framework- Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, and Elevation of Privilege
pentesting, static analysis 
Essentially make a strong secure design early on in development of an app.  

**• Security misconfiguration**- can be in cloud deployments, web applications, network appliances, databases, and even within user privilege settings. Missing patches or improperly applied updates also count in this. Leads to bigger attacks

Scanning tools to detect unpatched/misconfig vulns
absence of a formal configuration management process is usually the culprit. 
manual configuration audits and compliance assessments 
Known frameworks- OWASP, NIST
config baseline scanning- validate the current state of systems against a pre-approved secure configuration
Firewalls and WAFs

**• End-of-life or outdated components**- software, hardware, or platform that is no longer supported by the original vendor. know End of life (no longer sold) & End of Service Life (no more patches/services)
includes Legacy systems. Treat these as as active vulnerabilities. Turns bad if components connect to critical infrastructure or store sensitive data w/out compensating controls. 

comprehensive and up-to-date asset inventory/management- visibility for EOL/legacy systems 
Risk based approach- systems that are more vulnerable (internet facing, etc)
Documenting the presence and management of EOL and legacy systems
compensating controls 
"surround" EOL or legacy systems with sec measures 
Continuous monitoring

**• Identification and authentication failures**- weak password policies, insecure credential storage mechanisms, poorly designed session management, and absent or improperly implemented multi-factor authentication. Credential stuffing attacks. All password/AuthN security Policies can lead to failure as well. 

MFA, Vuln scanners (Burp Suite and OWASP ZAP) for login flows, token handling, session persistence, and account recovery logic
Good Password policies
secure coding for correct authN flows 
Hardened Credential storage

**• Server-side request forgery**- vulnerable web server into making unauthorized or unintended requests to internal or external resources. requests to APIs, other resources, etc. Bypasses most security controls (controls wont look at api requests and such). like a stored CSRF attack

assessments of third-party integrations- services consume external data, interact with webhook URLs, or accept callback endpoints
Vuln scanners/Analysis tools- Burp Suite, OWASP ZAP, Acunetix, and Nessus to test for unsanitized input and unexpected response behaviors
WAFs/firewalls, especially bc this is for web servers. 
allowlist model for URLs
URL parsing and validation
Cloud tools 

**• Remote code execution (RCE)**- flaw in software, application logic, or system configuration allows an attacker to execute code on a remote device or server. Most damaging be of malicious code executing. starts with underlying software flaws like buffer overflows/ command injection
Common malware types delivered via RCE include ransomware, cryptominers, rootkits, and remote access trojans.

Reverse engineering Malicous payloads. 
Auto scanning and manual analysis- Nessus, Qualys, and OpenVAS, Burp Suite and OWASP ZAP
Pentesting- to test vulns 
secure software development practices

**• Privilege escalation**- usually leads to building out a persistent presence without getting caught.

Early detection and mitigation- effective monitoring and alerting
Vulnerability scanning tools highlight misconfigurations, outdated software, and improperly assigned permissions
Configuration audits- to validate security
Proper Remediation planning- structured prioritization of asset Remediation (top assets like business critical/sensitive data)
EDR, SIEM and UEBA- detect abnormal account behavior,

**• Local file inclusion (LFI)/remote file inclusion (RFI)**- web application dynamically includes files as part of its runtime behavior, and fails to properly validate user-supplied file path input, results in unauthorized file reading, disclosure of sensitive information, or remote execution of malicious scripts

Local File Inclusion refers to the ability of an attacker to include files that already reside on the server- aim to read files containing system configurations, credentials, application logs, or other sensitive information. Like directory traversing. 
Remote File Inclusion allows an attacker to include files hosted on external servers- leads to execution of attacker-controlled scripts or shell commands
Both result of insecure coding practices- input without without proper validation or sanitization
LFI- goal is reconnasaince
RFI- goal is RCE

Vuln scanning - Burp Suite, OWASP ZAP, Nikto, and Arachni
Pen testing and Threat Intel
secure development practices
allowlists for file path parameters
WAFs


All if not most of the attacks can be prevented by team training and cross-team collaboration, etc to be security-conscious and training to know how to prevent these attacks/vulns. 
- Threat intelligence
- Proper documentation
- Vuln scanning 
- Pen testing


> [!NOTE] TODO
> Put controls under each attack, understand the attack and how the controls mitigate it. 

